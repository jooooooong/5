import streamlit as st
import pandas as pd
import plotly.express as px

# -----------------------------
# ğŸ“Œ ì œëª© ë° ì„¤ëª…
# -----------------------------
st.title("ğŸ“Š ì–‘ì£¼2ë™ ì—°ë ¹ëŒ€ë³„ ì¸êµ¬ ë³€í™” ë¶„ì„ (2008â€“2024)")
st.markdown("""
ì´ ê·¸ë˜í”„ëŠ” ì–‘ì£¼2ë™ì˜ ì—°ë„ë³„ ì¸êµ¬ êµ¬ì¡° ë³€í™”ë¥¼ ì—°ë ¹ëŒ€ ê¸°ì¤€ìœ¼ë¡œ ë³´ì—¬ì¤ë‹ˆë‹¤.  
ì•„ë˜ì—ì„œ ì›í•˜ëŠ” ì—°ë ¹ëŒ€ë¥¼ ì„ íƒí•˜ë©´, í•´ë‹¹ ì¸êµ¬ì˜ ì‹œê°„ íë¦„ì— ë”°ë¥¸ ì¦ê°ì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
""")

# -----------------------------
# ğŸ“‚ CSV íŒŒì¼ ë¶ˆëŸ¬ì˜¤ê¸°
# íŒŒì¼ëª…ì€ ë°˜ë“œì‹œ ë™ì¼í•˜ê²Œ ìœ ì§€í•˜ê±°ë‚˜, ì•„ë˜ ê²½ë¡œ ìˆ˜ì •
# -----------------------------
df = pd.read_csv("population_in.csv")

# -----------------------------
# ğŸ” ë°ì´í„° ê¸°ë³¸ êµ¬ì¡° í™•ì¸
# í•„ìš”í•œ ê²½ìš° ì»¬ëŸ¼ ì´ë¦„ í™•ì¸ ë° ì •ì œ
# ì˜ˆ: ì»¬ëŸ¼ëª…ì´ 'ë…„ë„', 'ì—°ë ¹ëŒ€', 'ì¸êµ¬ìˆ˜' ë“±ì´ë¼ë©´ ì•„ë˜ì²˜ëŸ¼ ìˆ˜ì •
# df.columns = ['year', 'age_group', 'population']
# -----------------------------
df.columns = ['year', 'age_group', 'population']  # í•„ìš” ì‹œ ìˆ˜ì •

# -----------------------------
# âœ… ì‚¬ìš©ì ì„ íƒ UI: ì—°ë ¹ëŒ€ ì„ íƒ
# -----------------------------
age_groups = sorted(df['age_group'].unique())

selected_ages = st.multiselect(
    "ğŸ” ë¶„ì„í•  ì—°ë ¹ëŒ€ë¥¼ ì„ íƒí•˜ì„¸ìš”:",
    age_groups,
    default=age_groups  # ê¸°ë³¸ì€ ì „ì²´ ì„ íƒ
)

# -----------------------------
# ğŸ“Œ í•„í„°ë§
# -----------------------------
filtered_df = df[df['age_group'].isin(selected_ages)]

# -----------------------------
# ğŸ“ˆ ì‹œê°í™” (Plotly ë¼ì¸ ì°¨íŠ¸)
# -----------------------------
fig = px.line(
    filtered_df,
    x='year',
    y='population',
    color='age_group',
    markers=True,
    labels={
        'year': 'ì—°ë„',
        'population': 'ì¸êµ¬ ìˆ˜',
        'age_group': 'ì—°ë ¹ëŒ€'
    },
    title="ì—°ë ¹ëŒ€ë³„ ì¸êµ¬ ë³€í™” ì¶”ì´ (2008â€“2024)"
)

fig.update_layout(
    height=550,
    xaxis=dict(dtick=1),
    legend_title_text='ì—°ë ¹ëŒ€'
)

st.plotly_chart(fig, use_container_width=True)

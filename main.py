import streamlit as st
import pandas as pd
import plotly.express as px

# -------------------------------
# 1. 페이지 제목
# -------------------------------
st.title("🏙️ 양주2동 회복 전략 제안")

st.markdown("""
인구 구성 변화와 연령대별 소비 특성을 기반으로  
양주2동 상권 회복을 위한 업종 및 시설을 제안합니다.
""")

# -------------------------------
# 2. 인구 구성비 변화 (수동 입력)
# -------------------------------
st.subheader("📈 연령대별 인구 구성비 변화 (2008 → 2024)")

pop_data = {
    "연령대": ["유아·아동층 (0~14세)", "청소년층 (15~19세)", "청년층 (20~34세)", "중년층 (35~54세)", "장년층 (55~64세)", "노년층 (65세 이상)"],
    "2008": [25.20, 4.33, 21.49, 33.81, 7.69, 7.48],
    "2024": [12.30, 6.61, 15.99, 31.90, 14.73, 18.47]
}
pop_df = pd.DataFrame(pop_data)
pop_melted = pop_df.melt(id_vars="연령대", var_name="연도", value_name="구성비")

fig1 = px.bar(pop_melted, x="연령대", y="구성비", color="연도",
              barmode="group", title="연령대별 인구 구성비 변화 (%)", height=500)
st.plotly_chart(fig1, use_container_width=True)

# -------------------------------
# 3. 소비 분석 데이터 (수동 입력)
# -------------------------------
st.subheader("💸 연령대별 업종 소비 금액 분석 (단위: 억원)")

data = {
    "연령대": ["20대", "30대", "40대", "50대", "60대"],
    "종합소매점": [0.83, 1.95, 4.47, 5.11, 2.92],
    "한식": [0.41, 1.34, 2.41, 2.68, 1.49],
    "연료판매": [0.71, 2.17, 4.17, 4.48, 2.38],
    "가전제품": [0.62, None, 1.99, None, 1.10],
    "음/식료품소매": [None, 0.77, 2.12, 2.60, 1.89],
    "일반병원": [None, None, None, 1.54, None]
}
df = pd.DataFrame(data)
df = df.fillna(0)
df_melted = df.melt(id_vars="연령대", var_name="업종", value_name="소비금액(억원)")

fig2 = px.bar(df_melted, x="업종", y="소비금액(억원)", color="연령대",
              barmode="group", title="연령대별 업종 소비 금액", height=600)
fig2.update_layout(xaxis_tickangle=-45)
st.plotly_chart(fig2, use_container_width=True)

# -------------------------------
# 4. 전략 제안 요약
# -------------------------------
st.subheader("✅ 회복 전략 제안 요약")

st.markdown("""
- **👴 증가한 연령층**  
  - 장년층(55~64세), 노년층(65세 이상) 인구 비중 증가  
  - 👉 **건강**, **생활 필수소비**, **편의시설** 중심의 업종 확대 필요

- **👶 감소한 연령층**  
  - 유아·아동층(0~14세), 청년층(20~34세) 비중 감소  
  - 👉 학원·유아교육·놀이시설 및 청년 트렌디 업종(카페 등) 축소 우려

- **🛍️ 소비 성향 기반 업종 제안**  
  - **50대~60대**: 한식, 연료판매, 일반병원, 대형마트, 식료품소매  
  - **30~40대**: 한식, 가전, 식료품, 연료  
  - **20대**: 한식, 종합소매, 연료, 가전은 소폭 소비

- **📌 제안 업종 및 시설**  
  - **실버 대상**: 내과, 정형외과, 한의원, 건강식품점, 실버카페  
  - **공통 편의시설**: 대형마트, 음식점, 생활용품점  
  - **공공 인프라**: 경로당, 복합문화공간, 교통 접근성 강화
""")
